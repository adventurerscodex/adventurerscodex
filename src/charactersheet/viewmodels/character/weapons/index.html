<div id="weapon-pane" class="ac-pane panel-body">
  <div class="h4 card-title">
    Weapons<br />
    <small>A weapon's To Hit bonus is automatically calculated based on
       your Strength or Dexterity, proficiency bonus, magical modifier,
       and property. Use the To Hit Modifier to adjust for features, feats,
       or special cases.</small>
  </div>
  <table class="table table-responsive table-ac-bordered table-hover" id="weaponTable">
    <thead >
      <tr class="ac-table-header">
        <th id="weaponTableWeaponHeader"
            data-bind="click: function(){sortBy('name');}">
          Weapon
          <span data-bind="css: sortArrow('name')"></span>
        </th>
        <th id="weaponTableToHitHeader"
            data-bind="click: function(){sortBy('totalBonus');}">
          To Hit
          <span data-bind="css: sortArrow('totalBonus')"></span>
        </th>
        <th id="weaponTableDamageHeader"
            data-bind="click: function(){sortBy('damageType');}">
          Damage
          <span data-bind="css: sortArrow('damage')"></span>
        </th>
        <th id="weaponTableRangeHeader"
            class="hidden-xs"
            data-bind="click: function(){sortBy('range');}">
          Range
          <span data-bind="css: sortArrow('range')"></span>
        </th>
        <th id="weaponTablePropertyHeader"
            class="hidden-xs  hidden-sm"
            data-bind="click: function(){sortBy('property');}">
          Property
          <span data-bind="css: sortArrow('property')"></span>
        </th>
        <th id="weaponTableQuantityHeader"
            class="hidden-xs"
            data-bind="click: function(){sortBy('quantity');}">
          Quantity
          <span data-bind="css: sortArrow('quantity')"></span>
        </th>
        <th>
          <a href="#" data-bind="{click: collapseAll}">
                  <span class="fa fa-minus"></span>
            </a>
        </th>
      </tr>
    </thead>
    <!-- ko if: loaded(), completeOn: 'render' -->
    <tbody>
      <!-- ko foreach: filteredAndSortedEntities -->
      <tr data-toggle="collapse"
          class="clickable expandRow weaponRow"
          data-bind="attr:{'data-target': `#weapon_list_${uuid()}`, id: `#weapon_row_${uuid()}`}">
        <td>
          <span data-bind="text: $component.shortName(name)"></span>&nbsp;
          <span data-bind="text: magicalModifierLabel, css: { badge: applyMagicalModifierLabel }"></span>
        </td>
        <td>
          <span data-bind="text: hitBonusLabel"></span>
        </td>
        <td>
          <span data-bind="css: weaponDamageIcon"></span>
          <span data-bind="text: damage"></span>
        </td>
        <td class="hidden-xs">
          <span data-bind="text: weaponRangeLabel"></span>
        </td>
        <td class="hidden-xs  hidden-sm">
          <span data-bind="text: $component.shortName(property)"></span>
        </td>
        <td class="hidden-xs">
          <span data-bind="text: quantity"></span>
        </td>
        <td>
          <span data-toggle="collapse"
                data-bind="attr:{'data-target': `#weapon_list_${uuid()}`}"
                class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr class="collapseRow">
        <td colspan="7">
          <flip-card params="{
            dataId: $data.uuid,
            tabId: 'equipment',
            collapsable: true,
            elementId: 'weapon_list',
            context: {
              data: $data,
              replaceInList: $component.replaceInList,
              addToList: $component.addToList,
              removeFromList: $component.removeFromList
            }
          }">
            <div class="front">
              <weapon-detail-view params="{
                   data: context.data,
                   containerId: elementId,
                   show: showFront,
                   flip: flip
                 }"></weapon-detail-view>
            </div>
            <div class="back">
              <weapon-form params="{
                  data: context.data,
                  containerId: elementId,
                  show: showBack,
                  flip: flip,
                  forceCardResize: forceCardResize,
                  replaceInParent: context.replaceInList,
                  removeFromParent: context.removeFromList
                 }"
              ></weapon-form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
      <tr class="collapseRow">
        <td colspan="7">
          <div id="add-weapon" class="collapse add-card">
            <weapon-form params="{
              containerId:'add-weapon',
                show: $component.addForm,
                flip: $component.toggleShowAddForm,
                addToParent: $component.addToList
               }"
            ></weapon-form>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="7">
          <div class="row">
          <div class="col-xs-4 text-muted">
            <small class="table-foot-content visible-xs"><span id="weaponTableTotalWeightSpan" data-bind="text: totalWeight"></span></small>
            <span class="table-foot-content hidden-xs">Weight: <span id="weaponTableTotalWeightSpan" data-bind="text: totalWeight"></span></span>
          </div>
          <div class="col-xs-4">
            <!-- ko ifnot: $component.addForm -->
            <button type="button"
                    class="btn btn-link btn-sm btn-block"
                    id="weaponAddButton"
                    data-toggle="collapse"
                    data-target="#add-weapon"
                    data-bind="click: $component.toggleShowAddForm"><i class="fa fa-plus"></i> Add Weapon</button>
            <!-- /ko -->
          </div>
          <div class="pull-right col-xs-4 text-muted" style="text-align: right">
            <small class="table-foot-content visible-xs"
                   data-bind="text: totalCost">
            </small>
            <span class="table-foot-content hidden-xs">Value:
              <span data-bind="text: totalCost"></span>
            </span>
          </div>
        </td>
      </tr>
    </tfoot>
    <!-- /ko -->
  </table>
</div>
