<div id="slot-pane">
  <div class="h4 card-title"> Spell Slots<br />
    <small>These slots are configurable to reset on a short or long rest. Click on a slot to edit it.</small>
  </div>
  <hr class="ac-table-header" />
  <table class="table table-responsive table-ac-bordered">
    <!-- ko ifnot: loaded(), completeOn: 'render' -->
    <tbody><tr><td><div class="loader-wrapper"><div class="loader"></div></div></td></tr></tbody>
    <!-- /ko -->
    <!-- ko if: loaded(), completeOn: 'render' -->
    <tbody>
      <!-- ko foreach: filteredAndSortedEntities -->
      <tr class="clickable expandRow trackedRow"
          data-toggle="collapse"
          data-bind="attr:{'data-target': `#spell_slot_${uuid()}`}">
        <td style="padding: 6px; width: 10%">Lvl&nbsp;<span data-bind="text: level"></span>
        </td>
        <td style="padding: 6px; width: 10%"
            class="hidden-xs">
          <div data-bind="attr: {'class': $component.resetsOnImg($data)}"></div>
        </td>
        <td style="padding: 6px; width: 5%">
          <mini-plus-minus params="value: used,
                    max: max, hideUp: true, onChange: ()=>{$component.onUsedChange($data)}">
          </mini-plus-minus>
        </td>
        <td style="padding: 6px; width: 5%">
          <mini-plus-minus params="value: used,
                    max: max, hideDown: true, onChange: ()=>{$component.onUsedChange($data)}">
          </mini-plus-minus>
        </td>
        <td style="padding: 6px; width: auto">
          <div style="padding: 10px"
              data-bind="barProgress: $component.mapToChart({max, used, level})"> </div>
        </td>
        <td style="padding: 6px; width: 5%">
          <span data-bind="text: parseInt(max()) - parseInt(used())"></span>&nbsp;/&nbsp;<span data-bind=" text: max"></span>
        </td>
        <td style="padding: 6px;" class="col-xs-1 text-right">
          <span data-toggle="collapse"
              data-bind="attr:{'data-target': `#spell_slot_${uuid()}`}"
              class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr class="collapseRow">
        <td colspan="7">
          <div class="collapse"
              data-bind="attr: {id:`spell_slot_${uuid()}`}">
            <spell-slot-form params="{
                data: $data,
                containerId: `spell_slot_${uuid()}`,
                flip: () => {$component.hideRow(`#spell_slot_${uuid()}`)},
                nextSlotLevel: null
             }">
            </spell-slot-form>
          </div>
        </td>
      </tr>
      <!-- /ko -->
    </tbody>
    <tfoot>
      <tr class="collapseRow">
        <td colspan="7">
          <div id="add-spell-slot"
              class="collapse">
            <spell-slot-form params="{
                  containerId: 'add-spell-slot',
                   show: $component.displayAddForm,
                   flip: $component.toggleShowAddForm,
                   nextSlotLevel: $component.nextSlotLevel
                }">
            </spell-slot-form>
          </div>
          <!-- ko ifnot: $component.displayAddForm -->
          <button type="button"
              class="btn btn-link btn-sm btn-block"
              id="proficiencyAddButton"
              data-toggle="collapse"
              data-target="#add-spell-slot"
              data-bind="click: $component.toggleShowAddForm"><i class="fa fa-plus"></i> Add Spell Slot</button>
          <!-- /ko -->
        </td>
      </tr>
    </tfoot>
    <!-- /ko -->
  </table>
</div>
