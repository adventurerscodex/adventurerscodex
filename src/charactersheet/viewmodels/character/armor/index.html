<div id="armor-pane"
     class="ac-pane panel-body">
  <div class="h4 card-title">
    Armor<br />
    <small>Armor Class calculations are based on your equipped Armor, Shield, Magical Modifiers, and Dexterity.
      Be sure to Don your armor and/or shield so your AC will be calculated.
    </small>
  </div>
  <table class="table table-responsive table-ac-bordered table-hover">
    <thead>
      <tr class="ac-table-header">
        <th data-bind="click: function(){sortBy('equipped');}">
          Equipped
        </th>
        <th data-bind="click: function(){sortBy('name');}">
          Armor
          <span data-bind="css: sortArrow('name')"></span>
        </th>
        <th class="hidden-xs"
            data-bind="click: function(){sortBy('type');}">
          Type
          <span data-bind="css: sortArrow('type')"></span>
        </th>
        <th data-bind="click: function(){sortBy('armorClass');}"
            class="ac-table-data-cell">
          Armor Class
          <span data-bind="css: sortArrow('armorClass')"></span>
        </th>
        <th>
          <a href="#"
             data-bind="{click: collapseAll}"><span class="fa fa-minus"></span></a>
        </th>
      </tr>
    </thead>
    <!-- ko if: loaded(), completeOn: 'render' -->
    <tbody>
      <!-- ko foreach: filteredAndSortedEntities -->
      <tr class="clickable expandRow"
          data-toggle="collapse"
          data-bind="css: {notCastable: !equipped() }, attr:{'data-target': `#armor_list_${uuid()}`}">
        <td class="memorize-spell"
            data-bind="click: $component.equipArmor">
          <div>
            <input type='checkbox'
                   class='ac-checkbox sr-only'
                   data-bind="checked: equipped, attr: {id: `equpped_${uuid()}`}"></input>
            <label data-bind="attr: {for: `equipped_${uuid()}`}"></label>
          </div>
        </td>
        <td><span data-bind="text: name"></span>&nbsp;
          <span data-bind="text: magicalModifierLabel, css: { badge: applyMagicalModifierLabel }"></span>
        </td>
        <td class="hidden-xs"><span data-bind="text: type"></span></td>
        <td class="ac-table-data-cell"><span data-bind="text: armorClass"></span></td>
        <td>
          <span data-toggle="collapse"
                data-bind="attr:{'data-target': `#armor_list_${uuid()}`}"
                class="rotate fa fa-chevron-left"></span>
        </td>
      </tr>
      <tr class="collapseRow">
        <td colspan="5">
          <flip-card params="{
                  dataId: $data.uuid,
                  tabId: $parent.tabId,
                  collapsable: true,
                  elementId: 'armor_list',
                  context: {
                    data: $data,
                    replaceInList: $component.replaceInList,
                    addToList: $component.addToList,
                    removeFromList: $component.removeFromList
                  }
                }">
            <div class="front">
              <armor-detail-view params="{
                     data: context.data,
                     containerId: elementId,
                     show: showFront,
                     flip: flip
                   }"></armor-detail-view>
            </div>
            <div class="back">
              <armor-form params="{
                  data: context.data,
                  containerId: elementId,
                  show: showBack,
                  flip: flip,
                  forceCardResize: forceCardResize,
                  replaceInParent: context.replaceInList,
                  removeFromParent: context.removeFromList
                 }"></armor-form>
            </div>
          </flip-card>
        </td>
      </tr>
      <!-- /ko -->
      <tr class="collapseRow">
        <td colspan="5">
          <div id="add-armor"
               class="add-form collapse">
            <armor-form params="{
                   containerId: 'add-armor',
                   show: $component.addForm,
                   flip: $component.toggleShowAddForm,
                   addToParent: $component.addToList
                  }"></armor-form>
          </div>
        </td>
      </tr>
    </tbody>
    <tfoot>
      <tr>
        <td colspan="5">
          <div class="row">
            <div class="col-xs-4 text-muted">
              <small class="table-foot-content visible-xs"><span data-bind="text: totalWeight"></span></small>
              <span class="table-foot-content hidden-xs">Weight:&nbsp;<span data-bind="text: totalWeight"></span></span>
            </div>
            <div class="col-xs-4">
              <!-- ko ifnot: $component.addForm -->
              <button type="button"
                      class="btn btn-link btn-sm btn-block"
                      data-toggle="collapse"
                      data-target="#add-armor"
                      data-bind="click: $component.toggleShowAddForm"><i class="fa fa-plus"></i> Add Armor</button>
              <!-- /ko -->
            </div>
            <div class="pull-right col-xs-4 text-muted"
                 style="text-align: right">
              <small class="table-foot-content"
                     data-bind="text: totalCost">
              </small>

            </div>
        </td>
      </tr>
    </tfoot>
    <!-- /ko -->
  </table>
</div>
