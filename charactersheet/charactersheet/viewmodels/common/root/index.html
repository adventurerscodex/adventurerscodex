<!-- Begin Nav -->
<nav class="navbar navbar-default navbar-static-top">
<div class="container-fluid">
  <div class="col-lg-10 col-xs-12 col-lg-offset-1">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
        data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span>
        <span class="icon-bar"></span><span class="icon-bar"></span>
      </button>
      <a href='//app.adventurerscodex.com' class="navbar-brand">
    	  <img data-bind="attr: { src: navLogo }"
    	       class="pull-left img-rounded inline-block brand-icon resize_logo_nav"
    	       alt="Adventurer's Codex"/>
        <span class="inline-block pull-right">Adventurer's Codex</span>
      </a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li><a href="//adventurerscodex.com"
               target="_blank">Blog</a></li>
        <li><a href="//tinyletter.com/adventurerscodex"
               target="_blank">Newsletter</a></li>
        <li><a href="https://www.patreon.com/bePatron?u=5313385"
               target="_blank">Become a Patron</a>
        </li>
      </ul>
<!--
  TODO Add login view model
-->
    </div>
  <!--/.nav-collapse -->
  </div>
</div>
</nav>

<!-- ko if: shouldShowApp -->
<div class="container-fluid main">
  <div class="col-lg-10 col-xs-12 col-lg-offset-1">
  <div id="characters" class="container-fluid characters-module-style">
    <div class="row">
      <div class="col-sm-12">
        <div class="row">
          <div class="col-padded col-sm-2 col-xs-12">
            <player-image></player-image>
          </div>
          <div class="col-padded col-sm-10 col-xs-12 characters-player-name">
            <!-- TODO: Fix these and break them into their own components -->
            <!-- with: childRootViewModel -->
            <!-- if: playerType().key == 'character' -->
            <!-- with: profileTabViewModel().profileViewModel -->
            <div class="row">
              <div class="col-md-12 text-center-xs text-left-sm">
                <div class="h3" id="characterName" autocomplete="off" autocorrect="off"
                  spellcheck="false" data-bind="contenteditable: {
                  text: characterName,
                  placeholder: placeholderText
                }"></div>
              </div>
            </div>
            <!-- / -->
            <!-- / -->
            <!-- / -->
            <!-- with: childRootViewModel -->
            <!-- if: playerType().key == 'dm' -->
            <!-- with: campaignTabViewModel().campaignOverviewViewModel -->
            <div class="row">
              <div class="col-md-12 text-center-xs text-left-sm">
                <div class="h3" id="dmName" autocomplete="off" autocorrect="off"
                  spellcheck="false" data-bind="contenteditable: {
                  text: name,
                  placeholder: placeholderText
                }"></div>
              </div>
            </div>
            <!-- / -->
            <!-- / -->
            <!-- / -->
            <div class="row">
              <div class="col-md-12 text-center-xs text-left-sm">
                <i class="small underline"><a data-toggle="modal"
                  data-target="#newModal" href="#">New/Import</a>
                </i>
                &nbsp;
                <i class="small underline"><a data-toggle="modal"
                  data-target="#charactersModal" href="#">Characters and Games</a>
                </i>
                &nbsp;
                <i class="small underline">
                  <a data-bind="click: togglePartyManagerModal" href="#">Manage Party</a>
                </i>
                &nbsp;
                <i class="small underline"><a class="" data-toggle="modal"
                  data-target="#exportModal"
                  data-bind="click: charactersViewModel.selectCharacter"
                  href="#">Export</a></i>
              </div>
            </div>
            <!-- ko with: childRootViewModel -->
            <!-- ko if: playerType().key == 'character' -->
            <div class="row row-padded">
              <div class="col-xs-12">
                  <player-status-line></player-status-line>
              </div>
            </div>
            <!-- /ko -->
            <!-- TODO: Convert this to the new component style -->
            <!-- ko if: playerType().key == 'dm' -->
            <div class="row row-padded">
              <div class="col-xs-12">
                <party-status-line></party-status-line>
              </div>
            </div>
            <!-- /ko -->
            <div class="row">
              <div class="col-xs-12">
                <small data-bind="html: partyStatus"></small>
              </div>
            </div>
            <!-- /ko -->
          </div>
        </div>
      </div>
      </div>
    </div>
    <div class="spacer"></div>
    <!-- TODO: This if/else is ugly and unneeded.  -->
    <!-- ko with: childRootViewModel -->
      <!-- ko if: playerType().key == 'character' -->
      <character-root></character-root>
      <!-- /ko -->
      <!-- ko if: playerType().key == 'dm' -->
      <dm-root></dm-root>
      <!-- /ko -->
    <!-- /ko -->
	</div>
</div>
<!-- New Modal -->
<div class="modal fade" id="newModal" tabindex="-1" role="dialog"
aria-labelledby="newLabel">
<div class="modal-dialog" role="document">
  <div class="modal-content container-fluid">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal"
        aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <h4 class="modal-title" id="settingsLabel"
        data-dismiss="modal">Create a new character or campaign</h4>
    </div>
    <div class="modal-body">
      <p>If you play more than one character,
        run multiple campaigns, or do a little of both, you're
        in luck! Create a new character or campaign and then use
        the "Characters and Games" menu to switch between them.</p>
    </div>
    <div class="modal-footer">
      <button data-bind="click: showWizard"
        data-dismiss="modal" type="submit"
        class="btn btn-primary">Get started!
      </button>
    </div>
  </div>
</div>
</div>
<!-- Switch Characters Modal -->
<div class="modal fade" id="charactersModal" tabindex="-1" role="dialog"
  aria-labelledby="charactersModalLabel">
  <characters></characters>
</div>
<!-- Party Manager Modal -->
<div class="modal fade" id="partyModal" tabindex="-1" role="dialog"
  aria-labelledby="partyModalLabel"
  data-bind="modal: {
  open: partyManagerModalStatus,
  onclose: partyModalFinishedClosing
  }">
  <party-manager></party-manager>
</div>
<!-- Export Modal -->
<div class="modal fade" id="exportModal" tabindex="-1" role="dialog"
data-bind="with: charactersViewModel"
aria-labelledby="exportModalLabel">
<div class="modal-dialog" role="document" data-bind="with: selectedCharacter">
  <div class="modal-content container-fluid">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <h4 class="modal-title" id="exportModalLabel" data-dismiss="modal">Export</h4>
    </div>
    <div class="modal-body">
      <p>Save your character or campaign to a file for easy access in the future! Put it in Dropbox for added convenience.</p>
      <p>Note: Safari users will need to save the contents of the page.</p>
      <!-- ko ifnot: $parent.isLoggedIn -->
      <p class="text-warning">You must be logged in to export directly to Dropbox.</p>
      <!-- /ko-->
    <!-- Add export form. -->
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-primary" data-bind="click: saveToFile" data-dismiss="modal">Export to file</button>
      <!-- ko if: $parent.isLoggedIn -->
      <button type="button" class="btn btn-primary" data-bind="click: saveToDropbox" data-dismiss="modal">Export to Dropbox</button>
      <!-- /ko-->
    </div>
  </div>
</div>
</div>
<!-- /ko -->

<!-- ko if: shouldShowWizard -->
<wizard></wizard>
<!-- /ko -->

<!-- ko if: shouldShowPicker -->
<character-picker></character-picker>
<!--
<div id="picker" class="container-fluid main"
  data-bind="with: charactersViewModel">
  <div data-bind="template: {
    name: 'character_picker.tmpl',
    templateUrl: 'templates/common',
    data: $data }"></div>
</div>
 -->
<!-- /ko -->
